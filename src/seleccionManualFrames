import cv2
import os

# Rutas de entrada y salida
input_folder = "frames"
output_folder_crest = "dataset/wave_crest"
output_folder_trough = "dataset/wave_trough"
output_folder_discarded = "dataset/discarded"  # OpciÃ³n para imÃ¡genes no Ãºtiles

# Crear carpetas si no existen
os.makedirs(output_folder_crest, exist_ok=True)
os.makedirs(output_folder_trough, exist_ok=True)
os.makedirs(output_folder_discarded, exist_ok=True)

# Obtener lista ordenada de frames
frame_list = sorted(os.listdir(input_folder))

print("ğŸ“Œ Controles:")
print("â¡ï¸ 'c' â†’ Guardar en wave_crest")
print("â¡ï¸ 't' â†’ Guardar en wave_trough")
print("â¡ï¸ 'd' â†’ Descartar imagen")
print("â¡ï¸ 'q' â†’ Salir")

for frame in frame_list:
    img_path = os.path.join(input_folder, frame)
    img = cv2.imread(img_path)

    if img is None:
        print(f"âš ï¸ Error al cargar {frame}, se omitirÃ¡.")
        continue

    cv2.imshow("Selecciona la categorÃ­a (c/t/d) - Presiona 'q' para salir", img)

    key = cv2.waitKey(0) & 0xFF  # Espera por entrada del usuario

    if key == ord('c'):  # Guardar en wave_crest
        cv2.imwrite(os.path.join(output_folder_crest, frame), img)
        print(f"âœ… {frame} guardado en wave_crest")
    elif key == ord('t'):  # Guardar en wave_trough
        cv2.imwrite(os.path.join(output_folder_trough, frame), img)
        print(f"âœ… {frame} guardado en wave_trough")
    elif key == ord('d'):  # Descartar imagen
        cv2.imwrite(os.path.join(output_folder_discarded, frame), img)
        print(f"ğŸ—‘ï¸ {frame} descartado")
    elif key == ord('q'):  # Salir del programa
        print("ğŸšª Saliendo...")
        break

cv2.destroyAllWindows()
